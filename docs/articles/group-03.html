<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Part 3: Using cowplot to construct multi-panel figures • ubcBIOL548L</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Part 3: Using cowplot to construct multi-panel figures">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ubcBIOL548L</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/group-01.html">Part 1: Fundamentals of data import, structuring, and plotting in tidyverse</a>
    </li>
    <li>
      <a href="../articles/group-02.html">Part 2: Piping and producing single-panel ggplot figures</a>
    </li>
    <li>
      <a href="../articles/group-03.html">Part 3: Using cowplot to construct multi-panel figures</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Part 3: Using cowplot to construct multi-panel figures</h1>
                        <h4 class="author">Vikram B. Baliga, Andrea Gaede and Shreeram Senthivasan</h4>
            
            <h4 class="date">Last updated on 2019-10-27 13:24:06</h4>
      
      
      <div class="hidden name"><code>group-03.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This post is part of an R workshop created for BIOL 548L, a graduate-level course on data visualization taught at the University of British Columbia.<br>
All code and contents of this post were written together by Vikram B. Baliga, Andrea Gaede and Shreeram Senthivasan.</p>
<p>There are three groups with increasing levels of difficulty. Please see <a href="https://beep-boopr.github.io/ubcBIOL548L/articles/group-01.html">here</a> for Group 1’s vignette and <a href="https://beep-boopr.github.io/ubcBIOL548L/articles/group-02.html">here</a> for Group 2’s vignette.</p>
</div>
<div id="group-3-make-a-multi-panel-figure-with-a-clear-narrative-arc" class="section level2">
<h2 class="hasAnchor">
<a href="#group-3-make-a-multi-panel-figure-with-a-clear-narrative-arc" class="anchor"></a>Group 3: Make a multi-panel figure with a clear narrative arc</h2>
<div id="learning-objectives" class="section level3">
<h3 class="hasAnchor">
<a href="#learning-objectives" class="anchor"></a>Learning Objectives:</h3>
<ol style="list-style-type: decimal">
<li>Plan a sequence of plots that support a declarative statement of a result</li>
<li>Construct a multi-panel figure using cowplot</li>
<li>Evaluate which among a diversity of plotting options most effectively communicates a logical argument</li>
</ol>
</div>
<div id="lesson" class="section level3">
<h3 class="hasAnchor">
<a href="#lesson" class="anchor"></a>Lesson:</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co">#library(ubcBIOL548L)</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">## Loading packages and data</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">## If a package is installed, it will be loaded. If any are not, the missing</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">## package(s) will be installed from CRAN and then loaded.</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">## Modified from: </span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">## https://vbaliga.github.io/verify-that-r-packages-are-installed-and-loaded/</span></a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">## First specify the packages of interest</span></a>
<a class="sourceLine" id="cb1-11" title="11">packages &lt;-</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"gapminder"</span>,</a>
<a class="sourceLine" id="cb1-13" title="13">    <span class="st">"ggplot2"</span>,</a>
<a class="sourceLine" id="cb1-14" title="14">    <span class="st">"tidyr"</span>,</a>
<a class="sourceLine" id="cb1-15" title="15">    <span class="st">"dplyr"</span>,</a>
<a class="sourceLine" id="cb1-16" title="16">    <span class="st">"tibble"</span>,</a>
<a class="sourceLine" id="cb1-17" title="17">    <span class="st">"readr"</span>,</a>
<a class="sourceLine" id="cb1-18" title="18">    <span class="st">"forcats"</span>,</a>
<a class="sourceLine" id="cb1-19" title="19">    <span class="st">"readxl"</span>,</a>
<a class="sourceLine" id="cb1-20" title="20">    <span class="st">"ggthemes"</span>,</a>
<a class="sourceLine" id="cb1-21" title="21">    <span class="st">"magick"</span>,</a>
<a class="sourceLine" id="cb1-22" title="22">    <span class="st">"grid"</span>,</a>
<a class="sourceLine" id="cb1-23" title="23">    <span class="st">"cowplot"</span>,</a>
<a class="sourceLine" id="cb1-24" title="24">    <span class="st">"ggmap"</span>,</a>
<a class="sourceLine" id="cb1-25" title="25">    <span class="st">"maps"</span>)</a>
<a class="sourceLine" id="cb1-26" title="26"><span class="co">## Now load or install&amp;load all</span></a>
<a class="sourceLine" id="cb1-27" title="27">package.check &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(</a>
<a class="sourceLine" id="cb1-28" title="28">  packages,</a>
<a class="sourceLine" id="cb1-29" title="29">  <span class="dt">FUN =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb1-30" title="30">    <span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(x, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)) {</a>
<a class="sourceLine" id="cb1-31" title="31">      <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(x, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-32" title="32">                       <span class="dt">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>)</a>
<a class="sourceLine" id="cb1-33" title="33">      <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(x, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-34" title="34">    }</a>
<a class="sourceLine" id="cb1-35" title="35">  }</a>
<a class="sourceLine" id="cb1-36" title="36">)</a></code></pre></div>
<div id="prep-work-for-figure-legends" class="section level4">
<h4 class="hasAnchor">
<a href="#prep-work-for-figure-legends" class="anchor"></a>Prep work for figure legends:</h4>
<p><strong>Bird head icons</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">icon_hb &lt;-<span class="st"> "graphics/hummingbird.png"</span></a>
<a class="sourceLine" id="cb2-2" title="2">icon_zb &lt;-<span class="st"> "graphics/zeebie.png"</span></a>
<a class="sourceLine" id="cb2-3" title="3">icon_pg &lt;-<span class="st"> "graphics/pigeon.png"</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># Colours for the different birds</span></a>
<a class="sourceLine" id="cb2-6" title="6">col_hb &lt;-<span class="st"> "#ED0080"</span></a>
<a class="sourceLine" id="cb2-7" title="7">col_zb &lt;-<span class="st"> "#F48D00"</span></a>
<a class="sourceLine" id="cb2-8" title="8">col_pg &lt;-<span class="st"> "#4AA4F2"</span></a>
<a class="sourceLine" id="cb2-9" title="9"></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co"># Parts for drawing legends</span></a>
<a class="sourceLine" id="cb2-11" title="11">rect_hb   &lt;-<span class="st"> </span><span class="kw">rectGrob</span>(<span class="dt">width =</span> <span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_hb))</a>
<a class="sourceLine" id="cb2-12" title="12">rect_hb_t &lt;-<span class="st"> </span><span class="kw">rectGrob</span>(</a>
<a class="sourceLine" id="cb2-13" title="13">               <span class="dt">width =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-14" title="14">               <span class="dt">height =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-15" title="15">               <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_hb, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb2-16" title="16">             )</a>
<a class="sourceLine" id="cb2-17" title="17">rect_zb   &lt;-<span class="st"> </span><span class="kw">rectGrob</span>(<span class="dt">width =</span> <span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_zb))</a>
<a class="sourceLine" id="cb2-18" title="18">rect_zb_t &lt;-<span class="st"> </span><span class="kw">rectGrob</span>(</a>
<a class="sourceLine" id="cb2-19" title="19">               <span class="dt">width =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-20" title="20">               <span class="dt">height =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2-21" title="21">               <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_zb, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb2-22" title="22">             )</a>
<a class="sourceLine" id="cb2-23" title="23">rect_pg   &lt;-<span class="st"> </span><span class="kw">rectGrob</span>(<span class="dt">width =</span> <span class="dv">2</span>, <span class="dt">height =</span> <span class="dv">1</span>, <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_pg))</a>
<a class="sourceLine" id="cb2-24" title="24">point_hb  &lt;-<span class="st"> </span><span class="kw">pointsGrob</span>(</a>
<a class="sourceLine" id="cb2-25" title="25">               <span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-26" title="26">               <span class="dt">y =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-27" title="27">               <span class="dt">pch =</span> <span class="dv">24</span>,</a>
<a class="sourceLine" id="cb2-28" title="28">               <span class="dt">size =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="dt">units =</span> <span class="st">"char"</span>),</a>
<a class="sourceLine" id="cb2-29" title="29">               <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_hb)</a>
<a class="sourceLine" id="cb2-30" title="30">             )</a>
<a class="sourceLine" id="cb2-31" title="31">point_zb  &lt;-<span class="st"> </span><span class="kw">pointsGrob</span>(</a>
<a class="sourceLine" id="cb2-32" title="32">               <span class="dt">x =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-33" title="33">               <span class="dt">y =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2-34" title="34">               <span class="dt">pch =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb2-35" title="35">               <span class="dt">size =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="dt">units =</span> <span class="st">"char"</span>),</a>
<a class="sourceLine" id="cb2-36" title="36">               <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fill =</span> col_zb)</a>
<a class="sourceLine" id="cb2-37" title="37">             )</a></code></pre></div>
</div>
<div id="multi-panel-figures-can-be-driven-by-narrative" class="section level4">
<h4 class="hasAnchor">
<a href="#multi-panel-figures-can-be-driven-by-narrative" class="anchor"></a>Multi-panel figures can be driven by narrative</h4>
<p>one example: raw data -&gt; processing -&gt; analyses -&gt; punchline</p>
<p>We will used Figure 3 from <a href="https://www.cell.com/current-biology/fulltext/S0960-9822(16)31394-X">Gaede et al. 2017 paper</a> (Current Biology) as an example.</p>
<p>This study examined how neurons in the lentiformis mesencephali (LM) brain region of three species of birds respond to visual motion across the retina.</p>
<p>This figure shows that in hummingbirds, these neurons respond to faster visual motion speeds than those in zebra finches or pigeons.</p>
</div>
<div id="figure-3-panel-a" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-a" class="anchor"></a>Figure 3 Panel A:</h4>
<p><strong>Re-create panel A from Gaede et al. 2017</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># First, import data</span></a>
<a class="sourceLine" id="cb3-2" title="2">fig_A &lt;-</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw">read_csv</span>(<span class="st">"./Fig3A_data.csv"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="st">  </span><span class="co"># Now take every nth data point (produces plot faster)</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw">row_number</span>() <span class="op">%%</span><span class="st"> </span><span class="dv">5</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="co"># Clean outliers</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(spike) <span class="op">&lt;</span><span class="st"> </span><span class="dv">7</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span>(spike)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(time, spike)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="st">    </span><span class="kw">geom_path</span>(<span class="dt">size =</span> <span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="st">    </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="st">    </span><span class="co"># Y-axis vertical scale</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"segment"</span>,</a>
<a class="sourceLine" id="cb3-13" title="13">             <span class="dt">y =</span> <span class="fl">0.00278</span> <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span>, <span class="dt">yend =</span> <span class="fl">0.00278</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.01</span>,</a>
<a class="sourceLine" id="cb3-14" title="14">             <span class="dt">x =</span> <span class="fl">-1.5</span>, <span class="dt">xend =</span> <span class="fl">-1.5</span>,</a>
<a class="sourceLine" id="cb3-15" title="15">             <span class="dt">lwd =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="st">    </span><span class="co"># Y-axis scale label</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"text"</span>, <span class="dt">y =</span> <span class="fl">0.00278</span>, <span class="dt">x =</span> <span class="dv">-3</span>,</a>
<a class="sourceLine" id="cb3-18" title="18">             <span class="dt">label =</span> <span class="st">"0.2 mV"</span>, <span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">angle =</span> <span class="dv">90</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="st">    </span><span class="co"># X-axis scale bar</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"segment"</span>,</a>
<a class="sourceLine" id="cb3-21" title="21">             <span class="dt">y =</span> <span class="fl">-0.035</span>, <span class="dt">yend =</span> <span class="fl">-0.035</span>,</a>
<a class="sourceLine" id="cb3-22" title="22">             <span class="dt">x =</span> <span class="dv">70</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span>, <span class="dt">xend =</span> <span class="dv">75</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb3-23" title="23">             <span class="dt">lwd =</span> <span class="fl">1.2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="st">    </span><span class="co"># X-axis scale label</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"text"</span>, <span class="dt">y =</span> <span class="fl">-0.04</span>, <span class="dt">x =</span> <span class="dv">74</span>,</a>
<a class="sourceLine" id="cb3-26" title="26">             <span class="dt">label =</span> <span class="st">"5s"</span>, <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="st">    </span><span class="co"># Large ticks</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"segment"</span>,</a>
<a class="sourceLine" id="cb3-29" title="29">             <span class="dt">y =</span> <span class="fl">-0.03</span>, <span class="dt">yend =</span> <span class="fl">-0.025</span>,</a>
<a class="sourceLine" id="cb3-30" title="30">             <span class="dt">x =</span> <span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">15</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>, <span class="dt">xend =</span> <span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">15</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb3-31" title="31">             <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="st">    </span><span class="co"># Small ticks within large ticks</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">"segment"</span>,</a>
<a class="sourceLine" id="cb3-34" title="34">             <span class="dt">y =</span> <span class="fl">-0.027</span>, <span class="dt">yend =</span> <span class="fl">-0.028</span>,</a>
<a class="sourceLine" id="cb3-35" title="35">             <span class="dt">x =</span> <span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">79</span>, <span class="dt">xend =</span> <span class="fl">1.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">79</span>,</a>
<a class="sourceLine" id="cb3-36" title="36">             <span class="dt">lwd =</span> <span class="fl">0.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="st">    </span><span class="co"># Arrows</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="st">    </span><span class="kw">annotate</span>(</a>
<a class="sourceLine" id="cb3-39" title="39">      <span class="dt">geom =</span> <span class="st">"segment"</span>,</a>
<a class="sourceLine" id="cb3-40" title="40">      <span class="dt">y =</span> <span class="fl">-0.0275</span>,</a>
<a class="sourceLine" id="cb3-41" title="41">      <span class="dt">yend =</span> <span class="fl">-0.0275</span>,</a>
<a class="sourceLine" id="cb3-42" title="42">      <span class="dt">x =</span> <span class="dv">-10</span> <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb3-43" title="43">      <span class="dt">xend =</span> <span class="dv">-10</span> <span class="op">+</span><span class="st"> </span><span class="fl">5.5</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">8</span> <span class="op">*</span><span class="st"> </span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb3-44" title="44">      <span class="dt">lwd =</span> <span class="fl">1.2</span>,</a>
<a class="sourceLine" id="cb3-45" title="45">      <span class="dt">arrow =</span> <span class="kw">arrow</span>(</a>
<a class="sourceLine" id="cb3-46" title="46">        <span class="co"># Control the direction of each arrow. first = left; last = right</span></a>
<a class="sourceLine" id="cb3-47" title="47">        <span class="dt">ends =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"first"</span>, <span class="st">"last"</span>, <span class="st">"last"</span>, <span class="st">"last"</span>,</a>
<a class="sourceLine" id="cb3-48" title="48">                 <span class="st">"first"</span>, <span class="st">"first"</span>, <span class="st">"first"</span>, <span class="st">"last"</span>),</a>
<a class="sourceLine" id="cb3-49" title="49">        <span class="co"># Control the size of each arrow head</span></a>
<a class="sourceLine" id="cb3-50" title="50">        <span class="dt">length =</span> <span class="kw">unit</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">6</span>), <span class="st">"pt"</span>),</a>
<a class="sourceLine" id="cb3-51" title="51">        <span class="dt">type =</span> <span class="st">"closed"</span></a>
<a class="sourceLine" id="cb3-52" title="52">        ),</a>
<a class="sourceLine" id="cb3-53" title="53">      <span class="co"># Use 'sharp' arrow heads</span></a>
<a class="sourceLine" id="cb3-54" title="54">      <span class="dt">linejoin =</span> <span class="st">'mitre'</span>)</a>
<a class="sourceLine" id="cb3-55" title="55"><span class="co">#&gt; Parsed with column specification:</span></a>
<a class="sourceLine" id="cb3-56" title="56"><span class="co">#&gt; cols(</span></a>
<a class="sourceLine" id="cb3-57" title="57"><span class="co">#&gt;   time = col_double(),</span></a>
<a class="sourceLine" id="cb3-58" title="58"><span class="co">#&gt;   stim = col_double(),</span></a>
<a class="sourceLine" id="cb3-59" title="59"><span class="co">#&gt;   spike = col_double()</span></a>
<a class="sourceLine" id="cb3-60" title="60"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb3-61" title="61">fig_A</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div id="create-and-save-panels-as-separate-ggplot-objects" class="section level3">
<h3 class="hasAnchor">
<a href="#create-and-save-panels-as-separate-ggplot-objects" class="anchor"></a>Create and save panels as separate <code>ggplot</code> objects</h3>
<div id="figure-3-panel-b" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-b" class="anchor"></a>Figure 3 Panel B:</h4>
<p><img src="group-03_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div id="figure-3-panel-c" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-c" class="anchor"></a>Figure 3 Panel C:</h4>
<p><img src="group-03_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div id="figure-3-panel-d" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-d" class="anchor"></a>Figure 3 Panel D:</h4>
<p><img src="group-03_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="figure-3-panel-e" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-e" class="anchor"></a>Figure 3 Panel E:</h4>
<p><img src="group-03_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div id="figure-3-panel-f" class="section level4">
<h4 class="hasAnchor">
<a href="#figure-3-panel-f" class="anchor"></a>Figure 3 Panel F:</h4>
<p><img src="group-03_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div id="intro-to-cowplot" class="section level4">
<h4 class="hasAnchor">
<a href="#intro-to-cowplot" class="anchor"></a>Intro to cowplot</h4>
<p>We’ll go over <code>plot_grid()</code> basics.<br><code>draw_image()</code> &amp; <code>draw_grob()</code> can also be used with <code>ggplot()</code> &amp; <code>plot_grid()</code></p>
<p><strong>Basics</strong></p>
<ul>
<li>Multiple panels can be combined via <code><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">cowplot::plot_grid()</a></code>
</li>
<li>Each panel should be saved as a separate ggplot object beforehand and then each will be fed in as an argument to <code>plot_grid()</code>
</li>
</ul>
<p><strong>Plot objects can be added sequentially</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C)</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p><strong>By default, additional panels are initially added within the same row.</strong><br><code>plot_grid()</code> then tends to prefer to have ncol = nrow as best as possible:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C, fig_E,</a>
<a class="sourceLine" id="cb5-2" title="2">          <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C, fig_E, fig_F,</a>
<a class="sourceLine" id="cb6-2" title="2">          <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-11-2.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C, fig_E, fig_F, fig_B,</a>
<a class="sourceLine" id="cb7-2" title="2">          <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-11-3.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C, fig_E, fig_F, fig_B, fig_C,</a>
<a class="sourceLine" id="cb8-2" title="2">          <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-11-4.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">plot_grid</span>(fig_B, fig_C, fig_E, fig_F, fig_B, fig_C, fig_E,</a>
<a class="sourceLine" id="cb9-2" title="2">          <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>,<span class="st">"4"</span>,<span class="st">"5"</span>,<span class="st">"6"</span>,<span class="st">"7"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-11-5.png" width="700"></p>
<p><strong>This looks okay, but we may prefer to have the plots arranged in one column.</strong><br>
Let’s first just focus on panels E and F.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">plot_grid</span>(fig_E, fig_F,</a>
<a class="sourceLine" id="cb10-2" title="2">          <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p><strong>Cowplot also allows you to add labels to panels as you’d see in a journal article.</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot_grid</span>(fig_E, fig_F,</a>
<a class="sourceLine" id="cb11-2" title="2">          <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb11-3" title="3">          <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"E"</span>,<span class="st">"F"</span>))</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p><strong>See the arguments of <code><a href="https://rdrr.io/pkg/cowplot/man/plot_grid.html">cowplot::plot_grid()</a></code> to see how labels can be adjusted.</strong><br>
We’ll adjust the size and (temporarily) change to a serif font.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">plot_grid</span>(fig_E, fig_F,</a>
<a class="sourceLine" id="cb12-2" title="2">          <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb12-3" title="3">          <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"E"</span>,<span class="st">"F"</span>),</a>
<a class="sourceLine" id="cb12-4" title="4">          <span class="dt">label_size =</span> <span class="dv">40</span>,</a>
<a class="sourceLine" id="cb12-5" title="5">          <span class="dt">label_fontfamily =</span> <span class="st">"serif"</span>)</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="re-create-gaede-et-al--2017-fig-3" class="section level4">
<h4 class="hasAnchor">
<a href="#re-create-gaede-et-al--2017-fig-3" class="anchor"></a>Re-create Gaede et al. 2017 Fig 3</h4>
<div id="lets-try-to-build-fig-3-from-gaede-et-al--2017" class="section level5">
<h5 class="hasAnchor">
<a href="#lets-try-to-build-fig-3-from-gaede-et-al--2017" class="anchor"></a>Let’s try to build Fig 3 from <a href="https://www.cell.com/current-biology/fulltext/S0960-9822(16)31394-X">Gaede et al. 2017</a>
</h5>
<p>The layout of the figure is complex; nrows and ncols can’t be set easily. Luckily we can build sets of panels together, save each one, then stitch it all together at the end.</p>
<p><strong>Let’s start with panels E and F.</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">cow_EF &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(fig_E, fig_F,</a>
<a class="sourceLine" id="cb13-2" title="2">                    <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb13-3" title="3">                    <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"E"</span>,<span class="st">"F"</span>),</a>
<a class="sourceLine" id="cb13-4" title="4">                    <span class="dt">label_size =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb13-5" title="5">                    <span class="dt">label_fontfamily =</span> <span class="st">"sans"</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">cow_EF</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p><strong>For panel A, we’ll adjust the padding around the margin.</strong><br>
Within the argument <code>plot.margin</code>, the order is top, right, bottom, left; think TRouBLe (T,R,B,L)</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">fig_A &lt;-<span class="st"> </span>fig_A <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">unit</span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="dv">0</span>, <span class="fl">5.5</span>), <span class="dt">units =</span> <span class="st">"pt"</span>))</a>
<a class="sourceLine" id="cb14-2" title="2">cow_A &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(<span class="ot">NULL</span>, fig_A,</a>
<a class="sourceLine" id="cb14-3" title="3">                   <span class="dt">rel_widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.07</span>, <span class="fl">0.93</span>),</a>
<a class="sourceLine" id="cb14-4" title="4">                   <span class="dt">nrow =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb14-5" title="5">                   <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"A"</span>,<span class="st">""</span>),</a>
<a class="sourceLine" id="cb14-6" title="6">                   <span class="dt">label_size =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb14-7" title="7">                   <span class="dt">label_fontfamily =</span> <span class="st">"sans"</span>)</a>
<a class="sourceLine" id="cb14-8" title="8">cow_A</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<p><strong>Panels B and C</strong><br>
When combining B and C, we should note that C has an x-axis label but B does not. Therefore, we will add blank plots (NULL) as padding and then adjust the relative heights to fit things comfortably. We still need to supply 4 labels, so "" will be used for blank plots.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">cow_BC &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(<span class="ot">NULL</span>, fig_B, <span class="ot">NULL</span>, fig_C,</a>
<a class="sourceLine" id="cb15-2" title="2">                    <span class="dt">rel_heights =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">-0.15</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb15-3" title="3">                    <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-4" title="4">                    <span class="dt">label_y =</span> <span class="fl">1.07</span>,</a>
<a class="sourceLine" id="cb15-5" title="5">                    <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">"B"</span>,<span class="st">""</span>,<span class="st">"C"</span>),</a>
<a class="sourceLine" id="cb15-6" title="6">                    <span class="dt">label_size =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb15-7" title="7">                    <span class="dt">label_fontfamily =</span> <span class="st">"sans"</span>)</a>
<a class="sourceLine" id="cb15-8" title="8">cow_BC</a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<p><strong>Panel D</strong><br>
Similarly, with panel D, we’ll add a NULL object to the cowplot and adjust the relative heights to the proportions we’d like.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">fig_D &lt;-<span class="st"> </span>fig_D <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Number of speed bins above threshold    "</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">cow_D &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(<span class="ot">NULL</span>, fig_D,</a>
<a class="sourceLine" id="cb16-3" title="3">                    <span class="dt">rel_heights =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">1.85</span>),</a>
<a class="sourceLine" id="cb16-4" title="4">                    <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb16-5" title="5">                    <span class="dt">label_y =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.07</span> <span class="op">/</span><span class="fl">1.85</span>,</a>
<a class="sourceLine" id="cb16-6" title="6">                    <span class="dt">labels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">""</span>,<span class="st">"D"</span>),</a>
<a class="sourceLine" id="cb16-7" title="7">                    <span class="dt">label_size =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb16-8" title="8">                    <span class="dt">label_fontfamily =</span> <span class="st">"sans"</span>)</a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co">#&gt; Warning: Removed 770 rows containing non-finite values (stat_boxplot).</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#&gt; Warning: Removed 770 rows containing missing values (geom_point).</span></a>
<a class="sourceLine" id="cb16-11" title="11">cow_D</a>
<a class="sourceLine" id="cb16-12" title="12"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p><strong>You can cowplot multiple cowplots</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">cow_BCD &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(cow_BC, cow_D,</a>
<a class="sourceLine" id="cb17-2" title="2">                     <span class="dt">rel_widths =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>),</a>
<a class="sourceLine" id="cb17-3" title="3">                      <span class="dt">nrow =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt; Warning: Removed 1 rows containing missing values (geom_text).</span></a>
<a class="sourceLine" id="cb17-7" title="7">cow_BCD</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div id="now-combine-all-the-panels-together" class="section level5">
<h5 class="hasAnchor">
<a href="#now-combine-all-the-panels-together" class="anchor"></a>Now combine all the panels together:</h5>
<p>It may help to specify the dimensions of the plot window to ensure that the plot is made with correct overall proportions.<br>
try(<code>dev.off(), silent = T</code>)<br><code><a href="https://rdrr.io/r/grDevices/dev.html">dev.new(width = 8, height = 11, units = "in")</a></code></p>
<p><strong>Now for the plot itself:</strong></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">cow_A2F &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(cow_A, <span class="ot">NULL</span>, cow_BCD, cow_EF,</a>
<a class="sourceLine" id="cb18-2" title="2">          <span class="dt">ncol =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb18-3" title="3">          <span class="co"># A negative rel_height shrinks space between elements</span></a>
<a class="sourceLine" id="cb18-4" title="4">          <span class="dt">rel_heights =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1.2</span>, <span class="fl">-0.2</span>, <span class="fl">2.5</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb18-5" title="5">          <span class="dt">label_size =</span> <span class="dv">18</span>,</a>
<a class="sourceLine" id="cb18-6" title="6">          <span class="dt">label_fontfamily =</span> <span class="st">"sans"</span>)</a>
<a class="sourceLine" id="cb18-7" title="7">cow_A2F</a></code></pre></div>
<p><img src="group-03_files/figure-html/unnamed-chunk-20-1.png" width="816"></p>
</div>
<div id="adding-icons-to-a-multipanel-plot" class="section level5">
<h5 class="hasAnchor">
<a href="#adding-icons-to-a-multipanel-plot" class="anchor"></a>Adding icons to a multipanel plot:</h5>
<p>The bird heads and other legend elements are conspicuously absent. The <code><a href="https://rdrr.io/pkg/cowplot/man/draw_image.html">cowplot::draw_image()</a></code> function allows for an image to be placed on the canvas, which we’ll use for the bird heads.</p>
<p>Similarly, <code><a href="https://rdrr.io/pkg/cowplot/man/draw_grob.html">cowplot::draw_grob()</a></code> places grobs (GRaphical OBjects). We’ll use this to add in colored rectangles for the legends.</p>
<p>Each image’s (or grob’s) location is specified with x- and y- coordinates. Each runs from 0 to 1, with (0,0) being the lower left corner of the canvas.</p>
<p>At the moment, vectorization of the code you see below doesn’t seem possible. It’s a bit tedious (and un-tidy!) but it works!</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#group-3-make-a-multi-panel-figure-with-a-clear-narrative-arc">Group 3: Make a multi-panel figure with a clear narrative arc</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrea Gaede, Vikram Baliga, Shree Senthivasan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
